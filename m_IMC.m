function [Y,Xf,Af] = myNeuralNetworkFunction(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 18-Jan-2024 14:37:46.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 1xQ matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = 18.5;
x1_step1_gain = 0.0930232558139535;
x1_step1_ymin = -1;

% Layer 1
b1 = [-139.99642568802847;-137.16991514284146;134.34343628195597;-131.51515153649899;-128.68686868688863;-125.85858585858615;123.03030303030303;120.20202020202028;117.37373737355193;114.54545451223498;-111.71717128912272;-108.8922373337771;106.0928149913132;-103.23227154358462;100.40403970057913;-97.57575757816042;-94.747474747479032;91.919191919191903;-89.090909090909093;86.262626262626256;-83.434343434343447;-80.606060606060595;-77.777777777777786;-74.949494949494948;-72.121212121212125;-69.292929292929287;66.464646464646464;63.63636363636364;60.80808080808081;57.979797979797979;55.151515151515092;-52.323232323176434;-49.494949506225694;46.666670430196426;43.836453776664506;-41.001753345162292;-38.181814016696265;-35.353535722209216;-32.525252528380371;-29.696969696965716;26.868686868686844;-24.040404040404042;21.212121212121207;18.383838383838377;-15.555555555555562;-12.727272727272732;9.8989898989898997;-7.0707070707070585;-4.2424242424267096;-1.4141414145587738;1.4141413272616854;4.2423804820122699;7.081289340515533;-9.8989304344798725;12.727272794609281;15.555555556809583;-18.383838383842015;21.212121212121204;-24.040404040404042;26.868686868687366;-29.696969697199915;-32.525252463885934;-35.353554156140532;-38.180611641151799;-41.012941118312582;43.838410165721427;46.666666667787695;49.494949494938538;-52.323232323230933;55.151515151515163;57.979797979797993;60.808080808036514;-63.63636362385266;-66.464650164519085;69.293621546296151;72.085463498083215;-74.949857452829235;-77.777780360936731;80.60606061323044;-83.434343434365132;86.262626262626057;-89.090909090909108;-91.919191919191675;94.747474747395358;97.575757568486097;100.40404406325553;-103.23197121016614;-106.05791393841221;-108.88888207663044;-111.71717169226707;-114.54545454539392;117.37373737373792;-120.20202020200894;-123.03030302188343;125.85858341119436;128.68763564470879;-131.52672177368567;-134.34342301210631;-137.17411746477916;-140.06017916993127];
IW1_1 = [140.00357431197153;140.00180202887569;-139.99999806147835;139.99999997865254;139.99999999998005;139.99999999999972;-140;-139.99999999999994;-140.0000000001414;-140.00000002533957;140.00000032651181;139.9974458373876;-139.97543132727452;140.00003942768899;-140.00000053659372;139.99999999816708;139.9999999999967;-140;140;-139.99999999999997;140;140;140;139.99999999999997;140;140;-140;-140;-140;-139.99999999999997;-140.00000000000003;140.00000000001666;139.99999999664337;-139.99999887969346;-140.00057453000016;140.00248488630734;140.00000123985021;139.99999989025522;139.9999999990689;140.00000000000119;-140;140;-140;-140;140;139.99999999999997;-140;140;140.00000000000011;140.00000000002134;140.00000000444498;140.00000223890478;139.99945858154467;-140.00000304237028;139.99999999655486;139.99999999993585;-139.9999999999998;140;-140;139.99999999999983;-139.99999999993469;-140.00000001741097;-139.99999466530736;-140.00034232084022;-139.99919420185626;139.99999253038331;139.99999999968196;140.0000000000031;-140.0000000000004;140;140;140.00000000002288;-140.00000000645915;-139.99999808983321;139.99964260407572;140.01845626589446;-139.99981284711581;-139.99999866636909;139.99999999629836;-139.99999999998877;140.00000000000009;-140;-140.00000000000017;140.00000000005943;140.00000000544514;139.99999725984352;-140.0002636072897;-140.00201596127073;-140.00000510127259;-140.00000001864953;-140.00000000004539;139.9999999999996;-140.00000000001052;-140.00000000787134;140.00000228802645;139.99928298360678;-139.98918315552086;-140.00001047563873;-139.99759969190544;-139.93982083005071];

% Layer 2
b2 = 0.56543096476654042;
LW2_1 = [0.085211978195392599 1.0348741891760889 0.034603432271013611 -0.57368392294465842 0.0049578183527671932 -0.66751845660561449 -0.22068248654085457 -0.35980596917846019 0.77187238617050602 0.39995687572394878 0.19454401813825628 1.0099914194878774 -0.83034410008464321 -0.14179867706809154 0.77663824343028032 0.91306146120481679 0.5052218181276118 0.15860097230988418 -0.23535042458333214 0.79398085844546218 -0.672378123744937 0.539244517945492 0.37102865978570554 0.74437776627266794 -0.12536174862837121 0.5777182136553497 0.59236722602218317 -0.43315300020959052 0.026449438782600587 0.88018446993397259 0.020543271102956621 -0.26107898593535217 0.31701688170386594 -0.35679390387391591 0.43685157672868608 -0.20985358847898936 -0.0834782480128414 0.32118313898053352 0.87716397113401789 -0.41279387968726589 0.74391016683697997 0.40984065386712959 0.97665271343894211 -0.86785094031218191 -0.35456582831477718 0.25700386789456764 -0.3686930810231846 -0.60753766604501469 0.3539533016778128 0.18084203246942554 0.11291326554403529 0.25250376064221824 -0.98390636234610629 -0.21063503001160369 -0.18921253731752902 -0.61008404889927248 0.52198407093783983 0.62047053966285959 -0.34509056541307442 0.37020761509814892 -0.63258017077018114 0.76533956233665423 -0.63091554617132728 0.26474989788621156 -0.251032263332573 0.6025539066481026 -0.0033822212699119447 -0.031755040608963322 0.76504116456464399 -0.30466009191559656 -0.11205660465016909 0.91611685586943747 -0.90446067954340215 0.95686234169350814 -0.63308824626859939 0.2307086399667419 0.40237548184365934 0.58076466269486882 -0.5084993957632834 0.47110036109945008 0.39175826319846946 -0.73094153816947471 -0.60170947643155126 0.71905982732560902 0.072155545889606251 -0.7680712905965742 0.038465521211366566 -0.5031251913541509 -0.20836635595916855 -0.22954435934101952 -0.081906196566303893 -0.9502953003119109 -0.049221354509701325 -0.50191975960266177 0.51354114578180843 -1.0666712969230807 1.1445460366566451 0.090833609198549076 -0.61370701261076022 -0.21637920669495389];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 2.38095238095238;
y1_step1_xoffset = 0.92;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
