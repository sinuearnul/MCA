function [Y,Xf,Af] = myNeuralNetworkFunction(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 19-Jan-2024 10:48:29.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timsteps
%   Each X{1,ts} = 2xQ matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [0;7.5];
x1_step1_gain = [0.00547945205479452;0.0784313725490196];
x1_step1_ymin = -1;

% Layer 1
b1 = [-14.000723835277945;-13.734028832924439;-13.445133698653123;13.036518693863755;12.578747722799413;-12.654818570434383;12.18414533737119;12.418228180826461;11.75581402590819;-11.486057754104962;-11.404087242950467;-10.777602491337138;10.592407719443592;10.419290975777752;-10.124267795528182;-9.5416130598469167;-9.4999912146261281;9.1672233432178398;9.0373756732275243;-8.4725011501159084;-8.0789568630716406;-8.012217625284805;7.8616883080933571;-7.4203113733509136;7.0081869118092524;-7.0179931850450492;6.8629016429731262;6.4492105033670137;6.1932912173639156;-6.0996951023435422;-5.5162945610973155;5.3951037785756881;4.773915462884001;4.4818618785004434;-4.5187422792240781;-4.089939031502472;3.7813412656916485;4.027501054156998;3.4144698842732919;-3.3662471023238156;-2.6523285441704201;2.4414277261437793;2.0779228104978524;-1.9733089353701236;1.3281754478848886;1.3314373677585689;-0.94820809023793151;0.57266994949556094;-0.42879874693014064;-0.082928249958761802;0.1758472520193648;-0.42125872282289983;0.63669885430538153;0.99323320216151334;-1.3648678589887806;1.5525044708647304;-1.8058501557340376;-2.0214229606500829;-2.63766481463129;2.7146569820327073;2.987769252071292;-3.2912259075433719;3.4872289319741876;-3.7635956769517422;4.1023872762582423;4.3931181085293076;-4.7712149098638603;4.8561453378799664;-5.0630854300483801;5.5226376591595026;-5.784532650960819;-5.9527473063076499;6.4841919966175032;6.6467222463428559;-6.7968080904941575;-7.2308919033270111;7.49488040977017;-7.778931098308921;8.0600305339152083;8.343459957309852;8.6794938820730021;-8.8955000543523823;-8.9863348400435576;9.4310149006458346;9.7575183842259943;10.03979379340193;10.321003295701301;10.607283081904486;-10.873666379781714;11.062543917139271;-11.686280154089598;-11.736936373723534;-12.01195735033815;12.286198178310054;12.59933417270568;12.935146624102089;13.159830507429447;13.573715625749784;13.665626777868244;13.91448985363828];
IW1_1 = [9.1182105945434362 -10.623150886318715;8.7413881830037568 -10.920473608401352;11.583848172206531 -7.8381533962682086;-12.914409923754707 5.6570148177623594;-11.997314295295578 7.6923506229537297;7.3984718691611082 11.806334458327685;-13.983391883783161 1.6627167037189854;-13.457964244898818 -2.3049324273261558;-13.751546995820584 2.5497598502748349;1.5275564951984331 13.874943494439805;9.5188898509205977 -9.9908734400712493;8.1192751319194407 11.516010820483546;-6.5416636902567342 -12.413271121517967;-13.817496976926611 -1.6913868438460082;11.398257874474098 -7.9778563364749528;13.479533351776809 -4.3115906616765907;9.0765339233812163 10.615784485885088;-8.3615331369484487 -11.252778858434395;-12.270699664226546 -6.6004203084755293;10.527740480659235 -9.3464261596963318;3.8109528689582741 -13.635438660247942;13.09764279633279 -5.0195273449546338;-10.520527598093119 9.1613355177456253;13.323860359392008 -4.4070328882180734;-12.917848332606161 -5.6743705279084766;9.9420733927885312 -9.7807401653832429;-7.6325889328966268 11.606903802534388;-7.223353765715423 -11.947757245599536;-4.1369334355145888 13.299303459296393;13.100290696124448 4.548751630904988;11.481720353711852 -8.0100373881771869;-8.5355520180090902 11.031580192067313;-7.6973920216892182 11.770430535586927;-13.97935150793495 -1.4241566791156479;6.5762311101596733 12.306415298806272;2.4641918481137539 13.783577054247719;-13.697251233373763 -2.9565168737127485;-12.488721098440374 -6.0549822237350259;-3.1843503402774291 13.592052962837299;9.6328117944371119 10.037654691244914;3.5498380992034781 13.551385247330899;-13.539474335199262 -3.5389271637748601;-12.347479398344268 6.5698883540868867;7.6732902500864508 11.658701414999317;-10.693274837832959 9.0754835964767047;-13.223826292282105 4.5779033169191834;11.716208265367722 -7.6562965263351641;-4.1728361398392098 -13.36772752248309;1.4061156319785957 -13.911562077316139;6.5239961301236917 -12.408621083484931;13.929114924122242 -1.3733723915234515;-4.7137402795553429 -13.170211301303597;4.6299140746738647 13.220058333192284;13.40771962082451 4.023644353195345;-9.1196318037507673 -10.60790531076699;2.5491571828765434 -13.760141624526046;-3.9105872280204226 -13.444756777938437;-13.607119271581398 -3.3316662198117228;-7.6664338075902769 -11.675834149987175;6.4663348372870564 -12.376112525276428;12.733110110836478 5.8055902543132767;-12.704756496638829 -5.8517336497136796;9.9140248275151368 9.9092572312174276;-13.71311846686126 -2.8939284492009638;13.885108357458245 -1.7884725067271097;7.7886988521496177 -11.640747496907043;-2.443819168413282 -13.730813966539131;6.778946829009902 -12.290069849429038;-0.27948516589173938 14.067377514555;10.730331537691777 -8.9872479761153237;-5.3951202920238739 12.915917877587196;-10.748279677074571 9.056378429228694;2.6839840387341014 13.67286680006335;13.994777475628043 -0.37861405157270706;-10.415971222500096 -9.4437458371663254;-3.3674727181585768 -13.567303067846597;13.849864039851997 2.0449181279269291;-12.168448151316142 6.921718689848162;13.248879215879134 -4.5249926322967937;13.851072331966003 -2.03653342924436;5.4510371156674333 12.84475993412395;-8.4543547248140207 11.167832354402865;-0.25406453167329462 -14.130090197535988;1.2575993767224365 13.963436943689768;13.830027590589991 2.1752772570418908;13.759642315921385 -2.5859885260708046;10.768238257780647 8.948708855230775;12.016005607643301 -7.1828931943134036;-4.0380343882298693 -13.412046328079967;13.494450560397389 4.0622520889435183;-2.4759702168341362 13.582089583060927;-11.784152589214209 -7.5591688993221133;-4.5343999065463931 13.251216078036148;5.3150231876435408 12.967994891355129;1.669070627679025 13.881611357341914;7.8695246863380905 -11.508672976762881;12.308280137385438 -6.652805819546658;9.6120931592603114 -9.9934197806461249;4.338339583438815 13.360528577885285;10.81061712499314 -9.0303056112278615];

% Layer 2
b2 = -0.080401983195913962;
LW2_1 = [-0.49160750516856222 0.45675342608351566 -0.38201803428697423 -0.022637409404357434 -0.23862339281396994 -0.00078667538031151896 0.30280952249317938 -0.42095262395006805 -0.46382233686841767 0.056851897416451802 -0.93557115245157241 0.68723136785450245 0.79060743875300443 -0.021032428803447467 -0.12960920962062428 0.52183510471538141 0.7522671290581765 0.22087574876062588 0.20061536944845804 -0.30335829954671645 0.39106375177196584 0.16777841612713118 -0.02532621506136512 -0.33797112057676881 0.056715257568428434 -0.10474934352230891 0.15490927123112941 0.39086188668307265 -0.72045915158231 0.86749570518441899 -0.14116436727807702 0.31834359606275398 0.11999094835293644 -0.018215487383270279 -0.27460462931192192 -0.25036354963146534 0.053681687373238252 0.98324045567252272 0.21536788677126095 0.92004170791099527 0.25057483483913884 -0.078307200978766978 0.082247948942717808 -0.31567142731994879 0.20233308905413683 -0.23360262962562245 -0.57151814641749921 0.24389154757428566 -0.095455246663554316 -0.51141743500006265 -0.20910313628335425 -0.47945750074612314 -0.27963781931792653 0.088681486628120365 -0.16614506244283211 0.35760666084433113 0.18279301426350358 -0.62607265399751044 -0.55315864060238296 0.029832481996201032 -0.034901781705028334 0.23017181406202869 -0.24360549832741157 0.49137653882238946 0.47749377985244656 0.80732640964960933 0.37971751485252536 -0.31736176763566781 -0.45681704503526993 -0.10525705299540916 -0.40956318979461026 0.70915118063683436 0.45127787050166457 0.21817947403748048 -0.4915808827954497 0.26289319807836109 -0.42732645868787023 -0.19044716660409419 -0.12661222508602432 0.18248700841378018 0.88221950279782424 0.34560751356302577 0.70978152991734245 -0.34847175172687805 0.16205526697552003 -0.79136051990380962 0.27525118537304311 0.3797903868844219 0.47890176409213553 1.0118861572593441 0.67087188067618675 0.058271982898812219 -0.83646164580307814 0.1351041431796913 -0.39339699024403724 -0.65265275159405867 -0.18172244554919692 -0.79173415571023964 0.38880737589015596 0.51648014121846852];

% Output 1
y1_step1_ymin = -1;
y1_step1_gain = 2;
y1_step1_xoffset = 1;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},2); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1_gain,y1_step1_xoffset,y1_step1_ymin);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings_gain,settings_xoffset,settings_ymin)
x = bsxfun(@minus,y,settings_ymin);
x = bsxfun(@rdivide,x,settings_gain);
x = bsxfun(@plus,x,settings_xoffset);
end
